;; http://rosettacode.org/wiki/24_game

(string-delimiter "")
;; check that nums are in expr, and only once
(define (is-valid? expr sorted: nums)
    (when (equal? 'q expr) (error "24-game" "Thx for playing"))
    (unless (and 
        (list? expr) 
        (equal? nums (list-sort < (filter number? (flatten expr)))))
    (writeln "ğŸƒ Please use" nums)
    #f))
    
;; 4 random  digits
(define (gen24)
     (->> (append (range 1 10)(range 1 10)) shuffle (take 4) (list-sort < )))
    
(define (is-24? num)
    (unless (= 24 num)
    (writeln "ğŸ˜§ Sorry - Result = " num)
    #f))

(define (check-24 expr)
    (if (and 
        (is-valid? expr nums) 
        (is-24?  (js-eval (string expr)))) ;; use js evaluator
        "ğŸ€ ğŸŒ¸ Congrats - (play24) for another one."
        (input-expr check-24 (string nums))))
        
(define nums null)
(define (play24)
    (set! nums (gen24))
    (writeln "24-game - Can you combine" nums "to get 24 â“ (q to exit)")
    (input-expr check-24 (string-append  (string nums) " -> 24 â“")))
    
    
    
    
    
    
    
(play24)
24-game - Can you combine     (2 5 6 7)     to get 24 â“ (q to exit) 
difficult game
ğŸƒ Please use     (2 5 6 7)    
12 * 2
ğŸƒ Please use     (2 5 6 7)    
6 * (7 - 5 + 2)
ğŸ€ ğŸŒ¸ Congrats - (play24) for another one.
    
(play24)
24-game - Can you combine     (3 5 8 9)     to get 24 â“ (q to exit)    
3 + 5 + 8 * 9
ğŸ˜§ Sorry - Result =      80    
9 * 3 - (8 - 5)
ğŸ€ ğŸŒ¸ Congrats - (play24) for another one.
    
(play24)
24-game - Can you combine     (1 8 8 9)     to get 24 â“ (q to exit)    
9 + 8 + 8 - 1
ğŸ€ ğŸŒ¸ Congrats - (play24) for another one.