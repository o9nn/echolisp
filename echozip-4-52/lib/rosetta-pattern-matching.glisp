
;;http://rosettacode.org/wiki/Pattern_matching


(require 'match)
(require 'struct)


(define (N-tostring n) (format "%s %d"  (N-color n) (N-value n)))
(struct N (color left value right) #:tostring N-tostring)

(define (balance t)
  (match t
    [(N 'âš«ï¸ (N 'ğŸ”´ (N 'ğŸ”´ a x b) y c) z d) (N 'ğŸ”´ (N 'âš«ï¸ a x b) y (N 'âš«ï¸ c z d))]
    [(N 'âš«ï¸ (N 'ğŸ”´ a x (N 'ğŸ”´ b y c)) z d) (N 'ğŸ”´ (N 'âš«ï¸ a x b) y (N 'âš«ï¸ c z d))]
    [(N 'âš«ï¸ a x (N 'ğŸ”´ (N 'ğŸ”´ b y c) z d)) (N 'ğŸ”´ (N 'âš«ï¸ a x b) y (N 'âš«ï¸ c z d))]
    [(N 'âš«ï¸ a x (N 'ğŸ”´ b y (N 'ğŸ”´ c z d))) (N 'ğŸ”´ (N 'âš«ï¸ a x b) y (N 'âš«ï¸ c z d))]
    [else t]))
    
    (define (ins value: x  tree: t)
    (match t
      ['empty (N 'ğŸ”´ 'empty x 'empty)]
      [(N c l v r) (cond [(< x v) (balance (N c (ins x l) v r))]
                         [(> x v) (balance (N c l v (ins x r)))]
                         [else t])]))
                         
	(define (insert value: x tree: s)
  		(match (ins x s) [(N _ l v r) (N 'âš«ï¸ l v r)]))
  	
(define (t-show n (depth 0))
	(when (!eq? 'empty n)
		(t-show (N-left n) (+ 12 depth))
		(writeln (string-pad-left (format "%s" n ) depth))
		(t-show (N-right n) (+ 12 depth))))
		
(define T (for/fold [t 'empty] ([i 32]) (insert (random 100) t)))
(define T (for/fold [t 'empty] ([i 16]) (insert i t)))
	
#|
(define T (for/fold [t 'empty] ([i 32]) (insert (random 100) t)))
[23]â†’ T
(t-show T)
                                                       ğŸ”´ 0    
                                           âš«ï¸ 3    
                               âš«ï¸ 6    
                                          âš«ï¸ 15    
                  ğŸ”´ 25    
                                          âš«ï¸ 29    
                                                      ğŸ”´ 33    
                              âš«ï¸ 37    
                                                      âš«ï¸ 38    
                                          ğŸ”´ 42    
                                                                  ğŸ”´ 43    
                                                      âš«ï¸ 44    
      âš«ï¸ 50    
                              âš«ï¸ 51    
                  âš«ï¸ 52    
                                          âš«ï¸ 60    
                              ğŸ”´ 61    
                                                      ğŸ”´ 65    
                                          âš«ï¸ 66    
âš«ï¸ 67    
                                          ğŸ”´ 73    
                              âš«ï¸ 75    
                  âš«ï¸ 81    
                              âš«ï¸ 87    
      âš«ï¸ 89    
                              âš«ï¸ 95    
                  âš«ï¸ 96    
                              âš«ï¸ 99    
|#
    
    
    