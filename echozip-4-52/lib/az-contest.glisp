;; AZ contest

;; input max_num
;; input numset : vector set of nums < max_num
;; compute ncount[a+b] for a,b in vset
;; plot ncount (a+b) at (a b)
;; hue = 0 .. 1 : count 0 to max_count

(require 'plot)

(define max-num 804)
(define max-score 327813)
(define numset #(  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239 240 241 242 243 244 245 246 247 248 249 250 251 252 253 254 255 256 257 258 259 260 261 262 263 264 265 266 267 268 269 270 271 272 273 274 275 276 277 278 279 280 281 282 283 284 285 286 287 288 289 290 291 292 293 294 295 296 297 298 299 300 301 302 303 304 305 306 307 308 309 310 311 312 313 314 315 316 317 318 319 320 321 322 323 324 325 326 327 328 329 330 331 332 333 334 335 336 337 338 339 340 341 342 343 344 345 346 347 348 349 350 351 352 353 354 355 356 357 358 359 360 361 362 363 364 365 366 367 368 369 370 371 372 373 374 375 376 377 378 379 380 381 382 383 384 385 386 387 388 389 390 391 392 393 394 395 396 397 398 399 400 401 402 403 404 405 406 407 408 409 410 411 412 413 414 415 416 417 418 419 420 421 422 423 424 425 426 427 428 429 430 431 432 433 434 435 436 437 438 439 440 441 442 443 444 445 446 447 448 449 450 451 452 453 454 455 456 457 458 459 460 461 462 463 464 465 466 467 468 469 470 471 472 473 474 475 476 477 478 479 480 481 482 483 484 485 486 487 488 489 490 491 492 493 494 495 496 497 498 499 500 501 502 503 504 505 506 507 508 509 510 511 512 513 514 515 516 517 518 519 520 521 522 523 524 525 526 527 528 529 530 531 532 533 534 535 536 537 538 539 540 541 542 543 544 545 546 547 548 549 550 551 552 553 554 555 556 557 558 559 560 561 562 563 564 565 566 567 568 569 570 571 572 573 574 575 576 577 578 579 580 581 582 583 584 585 586 587 588 589 590 591 592 593 594 595 596 597 598 599 600 601 602 603 604 605 606 607 608 609 610 611 612 613 614 615 616 617 618 619 620 621 622 623 624 625 626 627 628 629 630 631 632 633 634 635 636 637 638 639 640 641 642 643 644 645 646 647 648 649 650 651 652 653 654 655 656 657 658 659 660 661 662 663 664 665 666 667 668 669 670 671 672 673 674 675 676 677 678 679 680 681 682 683 684 685 686 687 688 689 690 691 692 693 694 695 696 697 698 699 700 701 702 703 704 705 706 707 708 709 710 711 712 713 714 715 716 717 718 719 720 721 722 723 724 725 726 727 728 729 730 731 732 733 734 735 736 737 738 739 740 741 742 743 744 745 746 747 748 749 750 751 752 753 754 755 756 757 758 759 760 761 762 763 764 765 766 767 768 769 770 771 772 773 774 775 776 777 778 779 780 781 782 783 784 785 786 787 788 789 790 791 792 793 794 795 796 797 798 799 800 ))
(define nscores #(  795 800 671 608 568 547 525 516 504 499 488 490 479 479 477 475 468 473 465 471 468 466 461 470 463 464 464 467 459 470 459 465 464 463 465 470 460 464 465 471 461 472 462 469 471 467 464 475 467 472 470 473 467 476 473 478 473 473 470 485 471 475 481 480 479 484 475 482 480 487 477 491 479 482 488 487 486 491 482 494 489 487 485 499 491 490 492 497 489 503 495 497 495 495 497 505 494 501 503 506 496 506 498 507 510 503 500 513 502 511 507 514 504 513 510 511 514 510 512 524 511 512 514 516 515 525 513 520 517 523 515 528 521 519 527 526 518 527 520 533 524 524 526 536 527 526 531 530 526 538 527 535 534 537 533 541 530 533 535 543 536 541 533 539 544 537 535 550 538 545 544 543 538 546 546 549 544 543 542 558 543 551 547 551 548 552 550 551 555 555 548 559 549 551 558 558 551 562 551 562 555 555 557 564 557 556 561 564 560 571 556 561 560 560 562 571 563 562 563 571 565 568 562 572 571 565 563 574 564 571 573 571 566 576 570 571 570 575 568 583 569 574 574 574 576 577 575 577 574 579 572 587 577 575 582 580 574 581 579 586 581 578 576 589 580 584 580 581 578 590 578 586 587 581 586 589 580 582 586 594 581 588 582 586 590 590 586 595 585 590 587 588 584 594 588 591 593 588 589 599 590 589 589 595 590 597 588 598 591 595 589 600 589 591 600 593 590 596 593 600 593 597 594 601 597 593 594 597 595 604 592 596 597 594 596 606 593 597 596 603 597 602 597 599 601 596 595 603 595 604 602 603 595 600 598 599 603 597 596 611 598 598 601 605 599 601 597 603 601 602 600 604 597 603 603 602 600 608 597 606 600 599 597 607 605 599 602 601 598 609 601 606 600 599 600 609 598 599 604 607 597 602 600 600 604 602 600 607 597 602 599 600 599 604 599 604 598 602 596 611 596 598 600 601 601 601 599 599 602 601 595 607 595 601 601 598 598 599 595 605 601 600 594 601 596 596 596 602 594 605 596 596 595 595 600 602 592 594 598 600 592 602 592 597 597 593 591 601 593 596 592 595 593 594 594 597 593 591 589 601 591 590 594 593 590 594 587 591 588 594 586 593 588 591 594 591 587 589 584 591 586 585 583 596 585 588 586 585 582 591 583 586 586 582 582 586 582 584 581 588 578 585 578 580 585 578 579 587 577 580 579 582 577 578 576 577 575 574 577 584 572 572 573 577 573 579 570 572 573 576 571 576 570 568 572 569 566 572 568 575 570 565 564 569 565 563 568 565 561 570 560 567 561 563 563 568 558 560 559 563 558 559 557 558 562 555 553 562 555 556 553 556 551 558 555 551 550 552 548 558 547 550 549 548 548 547 544 549 547 546 544 550 541 541 544 547 539 541 537 543 541 537 537 544 537 535 538 535 534 543 531 534 531 530 530 533 531 531 529 533 525 528 524 529 527 526 521 529 522 526 524 520 518 520 518 520 518 519 514 524 513 513 516 514 515 515 511 510 509 510 508 515 505 505 510 507 502 505 503 507 501 503 498 505 498 500 497 499 496 500 493 494 498 491 491 495 490 488 488 494 485 491 486 489 486 483 482 485 479 482 481 480 478 483 480 476 474 473 472 482 472 472 470 470 470 471 465 472 467 466 464 466 460 461 465 463 459 461 456 460 458 457 452 458 452 451 451 453 449 453 445 449 445 446 444 450 440 440 443 444 437 439 437 436 439 433 433 437 430 436 429 429 426 430 427 426 426 422 422 429 420 421 420 422 416 417 413 414 412 413 411 417 409 407 409 406 403 409 403 407 ))

;; DIM 200
(define max-num 814)
(define max-score 9456)
(define numset #(  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 18 20 21 22 24 25 26 27 28 30 32 33 35 36 39 40 42 44 45 48 49 50 52 54 55 56 60 63 64 65 66 70 72 75 77 78 80 81 84 88 90 91 96 98 99 100 104 105 108 110 112 117 120 121 125 126 128 130 132 135 140 143 144 147 150 154 156 160 162 165 168 175 176 180 182 189 192 195 196 198 200 208 210 216 220 224 225 231 234 240 242 243 245 250 252 256 260 264 270 273 275 280 286 288 294 297 300 308 312 315 320 324 325 330 336 343 350 351 352 360 363 364 375 378 384 385 390 392 396 400 405 416 420 432 440 441 448 450 462 468 480 484 486 490 495 500 504 512 525 528 539 540 550 560 567 576 588 594 600 605 616 625 630 640 648 660 672 675 686 693 700 704 720 726 729 735 750 756 768 770 784 792 800 810 ))
(define nscores #(  769 810 755 755 684 756 639 700 664 702 582 740 527 661 677 661 702 698 645 614 722 572 559 603 672 734 628 601 615 720 546 692 704 628 657 708 522 623 572 659 578 670 761 633 604 517 666 678 722 616 556 595 682 561 728 635 735 499 686 575 599 647 566 668 686 635 656 533 758 462 501 702 568 568 689 626 697 461 703 562 677 612 610 653 609 621 723 559 610 747 531 592 648 540 586 649 637 536 722 673 641 619 599 587 567 724 494 493 523 533 704 527 553 661 667 502 505 669 479 651 590 537 670 599 563 620 589 596 434 646 665 410 579 456 550 696 453 498 492 604 563 518 532 530 615 564 516 454 671 584 566 480 518 581 563 495 603 432 468 494 509 467 598 410 489 541 382 573 458 531 425 499 486 469 528 343 463 303 532 425 450 502 476 395 320 399 430 373 490 343 288 366 367 428 353 380 338 402 346 362 ))


	
;; plotting
(define (nplot)
	(plot-size max-num max-num)
	(plot-clear)
	(define PIX (pixels->uint32-vector)) ;; get canvas image
	
	(for ((a numset) (b nscores)) ;; vector index is x + y *width
	(for ((p (in-range (- max-num b) max-num)))
			(vector-set! PIX
			   (+ a ( * p max-num)) ;; coordinates : (0,0) is top-left corner
			   (rgb
			   		(if  (zero? (modulo a 2)) 1.0 0.5)
			   		(if  (zero? (modulo a 3)) 1.0 0.5)
			   		(if  (zero? (modulo a 5)) 1.0 0.5)
			   	))))
			   		
			       
	(vector->pixels PIX)) ;; draw canvas image
	
	



